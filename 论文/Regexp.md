## 目录
- [索引格式检查](#索引格式检查)
  - [作者](#作者)
    - [中文](#中文)
    - [英文](#英文)
  - [日期](#日期)
  - [标题\&期刊](#标题期刊)
    - [期刊论文](#期刊论文)
    - [学位论文](#学位论文)
- [上下文核对](#上下文核对)
  - [使用方法](#使用方法)
  - [运行原理](#运行原理)
- [创建框架](#创建框架)
- [识别大纲](#识别大纲)
  - [正文](#正文)
  - [标题](#标题)


# 索引格式检查
使用正则表达式匹配索引的各部分  
不匹配的部分将被标红  
运行错误部分将被突出显示 (遇到这种情况，请把这段索引发给我)  
***程序可能错误标红，以APA文档为准***
## 作者
不支持中英混合
### 中文
>张三, 李四四, 王五五五.   
>张三, 李四四, … 王五五五.  

姓名字数在 2-4 内，姓名后必须有逗号加一个空格  
\>=8个名字，最后姓名前要加省略号（三个英文句号）   
最后姓名后面必须为句号加一个空格
### 英文
>aa, A., b-b B. B., & c'c, C. C. C.   
>aa表示姓，A.表示名

每个作者必须包含姓和名，姓只有1个，名有 1-3 个  
姓后面必须有逗号加一个空格，名后面必须有句号  
姓可包含26个字母的大小写，和 `'-`，名只能为一个大写字母  
最后一个英文名的最后一个名后面必须有空格  
其他和[中文](#中文)一致
## 日期
>(2020b).   

必须要有括号，括号内必须有4个数字  
数字后可以跟一个小写字母  
括号后必须为一个句号加一个空格
## 标题&期刊
### 期刊论文
> 标题. 期刊, 1(2), 3-4+5.  
> 标题. 期刊, 1(2-3), 3-4+5.  
> 标题. 期刊, 1, 3-4+5.  
> 标题. 期刊, 1, Article e2. 

标题名不能包含括号  
期刊名包含所有中英文字符，和 `,-&:()' `，至少包含两个字符  
期号必须有且为数字，卷号可以没有，期号和卷号之间无空格  
页码必须有，内容可为纯数字，或者一个字母后加纯数字  
页码最多可连接三条，即 `1-2+3`
### 学位论文
>标题(硕士学位论文). 学校, 地区.   
>标题(博士学位论文). 学校, 地区.   
>title(Unpublished master's thesis). University, Area.   
>title(Unpublished doctorial dissertation). University, Area.   

学校包含所有中英文字符、英文上引号、空格，至少包含4个字符


# 上下文核对
> 建议进行核对索引的时候，点击 `视图-拆分窗口`  
> 最好提前把参考文献格式纠正后，再进行以下操作

| 核对结果 |          说明          |     查看     |
| :------: | :--------------------: | :----------: |
| 缺少索引 | 参考文献中无，正文中有 |  输出至批注  |
| 多余索引 | 参考文献中有，正文中无 |  输出至批注  |
| 正确匹配 | 参考文献中有，正文中有 | 索引日期标蓝 |
## 使用方法
1. 先选中参考文献，进行格式检查  
2. 选中参考文献对应的正文（比如：之前选中了整篇论文的参考文献，那这里就选中整篇论文除了参考文献的部分）  
3. 点击按钮，此时参考文献中，匹配成功的索引的日期将被标蓝

## 运行原理
1. 索引格式检查的时候，记录了选中的所有参考文献信息
2. 上下文核对的时候，先识别正文中的索引，然后和先前参考文献进行比对
3. 将所有识别结果输出至调试器的Console面板


# 创建框架
`Ctrl`+`A`选中文档全部后执行  
程序会生成json文件至`%LocalAppData%/Temp/wps/`文件夹下


# 识别大纲
选中文本后执行
## 正文
符合识别标准的文本包含两个部分 `标识文本`和`内容文本`  
程序会通过识别`标识文本`确定该文本的大纲级别  
> 标识文本中的**数字1**只是作为例子，你可以使用**任意数字**替代

|    标识文本    |  识别文本   | 大纲级别 |  样式  |
| :------------: | :---------: | :------: | :----: |
|     1 或1.     |   1 title   |    1     | 标题 1 |
|   1.1 或1.1.   |  1.1 title  |    2     | 标题 2 |
| 1.1.1 或1.1.1. | 1.1.1 title |    3     | 标题 3 |
|       无       |     无      |    10    |  正文  |
## 标题
程序会对前两段对齐方式为`居中`的文本识别为标题  
剩下的居中文本会被打上批注  
对第1个居中文本设置样式为`中文题目`  
对第2个居中文本设置样式为`作者姓名`  